var We=Object.defineProperty;var qe=(e,t,r)=>t in e?We(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var $=(e,t,r)=>(qe(e,typeof t!="symbol"?t+"":t,r),r);var Te=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}let Ne=!1;function ze(){Ne=!0}function w(e){let t;return()=>((!Ne||typeof t>"u")&&(t=e()),t)}function ne(e){if(!e)return!1;try{const{pathname:t}=new URL(e,location.origin);return t===location.pathname}catch{return!1}}function xe(e){var t,r,n;return(n=(r=(t=globalThis.chrome)==null?void 0:t.runtime)==null?void 0:r.getManifest)==null?void 0:n.call(r)}const ke=w(()=>{var e;return(e=globalThis.location)==null?void 0:e.protocol.startsWith("http")}),K=w(()=>{var e;return typeof((e=globalThis.chrome)==null?void 0:e.extension)=="object"}),Xe=w(()=>K()&&ke()),Je=()=>Qe()||Ze(),Qe=w(()=>{var t,r;const e=xe();return e&&ne(e.background_page||((t=e.background)==null?void 0:t.page))?!0:!!((r=e==null?void 0:e.background)!=null&&r.scripts&&ne("/_generated_background_page.html"))}),Ze=w(()=>{var e,t;return ne((t=(e=xe())==null?void 0:e.background)==null?void 0:t.service_worker)}),et=w(()=>{if(!K()||!chrome.runtime.getManifest)return!1;const{options_ui:e}=chrome.runtime.getManifest();return typeof(e==null?void 0:e.page)!="string"?!1:new URL(e.page,location.origin).pathname===location.pathname}),tt=w(()=>{if(!K()||!chrome.devtools)return!1;const{devtools_page:e}=chrome.runtime.getManifest();return typeof e!="string"?!1:new URL(e,location.origin).pathname===location.pathname}),rt=()=>{var e;return(e=globalThis.navigator)==null?void 0:e.userAgent.includes("Chrome")},Tn=()=>{var e;return!rt()&&((e=globalThis.navigator)==null?void 0:e.userAgent.includes("Safari"))},nt={contentScript:Xe,background:Je,options:et,devToolsPage:tt,extension:K,web:ke};function ot(){for(const[e,t]of Object.entries(nt))if(t())return e;return"unknown"}const On=e=>{window.open(e,"_blank","noreferrer")},Rn=e=>new Promise(t=>setTimeout(t,e)),En=e=>e.includes("https://www.bing.com/"),Pn=e=>e.includes("search.yahoo.com"),An=()=>new Promise(e=>{chrome.tabs.query({active:!0},async t=>{e(t[0])})});ze();const v={},Be=e=>Array.isArray(v[e]),st=e=>{if(Be(e))throw new Error(`Message with name "${e}" had been already registered.`);v[e]=[]},at=(e,t,r)=>{const n=v[e.name];for(const o of n)o(e.payload,t,r)},ct=(e,t)=>{v[e].push(t)},it=(e,t)=>{v[e]=v[e].filter(r=>r!==t)};chrome.runtime.onMessage.addListener((e,t,r)=>(Be(e.name)&&at(e,t,r),!0));const C=e=>(st(e),[async(n,o)=>{const a={name:e,payload:n};switch(ot()){case"contentScript":return chrome.runtime.sendMessage(a);case"extension":return chrome.runtime.sendMessage(a);case"background":if(typeof o=="number")return chrome.tabs.sendMessage(o,a);throw new Error("Param tabId have to be specified when sending messages from background script.");default:throw new Error("Unsupported messaging context")}},n=>(ct(e,n),()=>it(e,n))]);var S={},oe={},se={},ae={},u={},lt=Te&&Te.__awaiter||function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function c(f){try{l(n.next(f))}catch(h){s(h)}}function i(f){try{l(n.throw(f))}catch(h){s(h)}}function l(f){f.done?a(f.value):o(f.value).then(c,i)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(u,"__esModule",{value:!0});u.LOOSELY_IMMUTABLE_METHODS=u.STRICTLY_IMMUTABLE_METHODS=u.CONSTRUCTORS_UNSUPPORTED=u.CONSTRUCTORS_SUPPORTED=u.CONSTRUCTORS_COMPARABLE=u.CONSTRUCTORS_MUTABLE=u.CONSTRUCTORS_IMMUTABLE=u.$GET_RECORD_STOP=u.$GET_RECORD_START=u.$STOP=u.$TARGET=u.$IS_PROXY=u.IS_DEVELOPMENT=void 0;const ut=!1;u.IS_DEVELOPMENT=ut;const ft=Symbol("Is Proxy");u.$IS_PROXY=ft;const dt=Symbol("Proxy -> Target");u.$TARGET=dt;const ht=Symbol("Stop proxying");u.$STOP=ht;const pt=Symbol("Start recording get paths");u.$GET_RECORD_START=pt;const _t=Symbol("Stop recording get paths");u.$GET_RECORD_STOP=_t;const yt=new Set([Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError]),V=new Set([...yt,ArrayBuffer,Boolean,DataView,Number,RegExp,String,Symbol]);u.CONSTRUCTORS_IMMUTABLE=V;const G=new Set([(function*(){}).constructor,(function(){return lt(this,void 0,void 0,function*(){})}).constructor,Date,Function,Map,Object,Set,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array]);u.CONSTRUCTORS_MUTABLE=G;const H=new Set([Array,ArrayBuffer,RegExp,Map,Set,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array]);u.CONSTRUCTORS_COMPARABLE=H;typeof BigInt=="function"&&(V.add(BigInt),typeof BigInt64Array=="function"&&(G.add(BigInt64Array),H.add(BigInt64Array)),typeof BigUint64Array=="function"&&(G.add(BigUint64Array),H.add(BigUint64Array)));typeof SharedArrayBuffer=="function"&&V.add(SharedArrayBuffer);const gt=new Set([...V,...G,...H]);u.CONSTRUCTORS_SUPPORTED=gt;const St=new Set([Promise,WeakMap,WeakSet]);u.CONSTRUCTORS_UNSUPPORTED=St;const Tt=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf","includes","indexOf","join","lastIndexOf","toLocaleString","toString","has","getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","exec","test","subarray"]);u.STRICTLY_IMMUTABLE_METHODS=Tt;const Ot={array:new Set(["concat","entries","every","filter","find","findIndex","forEach","keys","map","reduce","reduceRight","slice","some","values"]),others:new Set(["entries","forEach","get","keys","values"])};u.LOOSELY_IMMUTABLE_METHODS=Ot;var ce={},ie={},le={},ue={};Object.defineProperty(ue,"__esModule",{value:!0});const{apply:A}=Reflect,Oe=(e,t,r)=>Math.max(t,Math.min(r,e)),m=(e,t)=>e<0?Oe(t+e,0,t):Oe(e,0,t),Rt=(e,t,r,n)=>{const{length:o}=r,a=m(n[0],o),s=n.length>=2?m(n[1],o):0,c=n.length>=3?m(n[2],o):o,i=c-s;for(let l=0,f=i;l<f&&!(a+l>=o);l++)if(r[s+l]!==r[a+l])return[A(e,t,n),!0];return[t,!1]},Et=(e,t,r,n)=>{const{length:o}=r,a=n[0],s=n.length>=2?m(n[1],o):0,c=n.length>=3?m(n[2],o):o;for(let i=s,l=c;i<l;i++)if(r[i]!==a)return[A(e,t,n),!0];return[t,!1]},je=(e,t,r,n)=>{const{length:o}=r;return o?[A(e,t,n),!0]:[void 0,!1]},Ge=(e,t,r,n)=>{const{length:o}=n;return o?[A(e,t,n),!0]:[r.length,!1]},Pt=(e,t,r,n)=>{const{length:o}=r,a=Math.floor(o/2);for(let s=0;s<=a;s++)if(r[s]!==r[o-s])return[A(e,t,n),!0];return[t,!1]},At=je,wt=void 0,Ct=(e,t,r,n)=>{const{length:o}=r,a=m(n[0],o),s=n.length>=2?Math.max(0,n[1]):o-a;if(Math.max(0,n.length-2)===s){if(!s)return[[],!1];for(let l=0,f=s;l<f;l++)if(r[a+l]!==n[2+l])return[A(e,t,n),!0];return[n.slice(2),!1]}return[A(e,t,n),!0]},Mt=Ge,mt={copyWithin:Rt,fill:Et,pop:je,push:Ge,reverse:Pt,shift:At,sort:wt,splice:Ct,unshift:Mt};ue.default=mt;var fe={};Object.defineProperty(fe,"__esModule",{value:!0});const{apply:vt}=Reflect,Ut=(e,t,r,n)=>{const o=r.getTime(),a=vt(e,t,n),s=r.getTime();return[a,o!==s]},$t={setDate:Ut};fe.default=$t;var de={},b={},he={};Object.defineProperty(he,"__esModule",{value:!0});const{assign:It}=Object,Dt=new Set([Map,Set,Date,RegExp]),Lt=e=>{const t=new Map;for(const[r,n]of e)t.set(F(r),F(n));return t},bt=e=>{const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t},Nt=e=>{const t=new Set;for(const r of e)t.add(F(r));return t},xt=e=>{if(typeof e!="object"||e===null)return e;if(typeof e.slice=="function")return e.slice();const{constructor:t}=e;if(Dt.has(t)){if(t===Map)return Lt(e);if(t===Set)return Nt(e);if(t===Date)return new Date(e.getTime());if(t===RegExp)return bt(e)}return It({},e)},F=e=>xt(e);he.default=F;var pe={};Object.defineProperty(pe,"__esModule",{value:!0});const{isArray:kt}=Array,Bt=new Set([Map,Set,Date,RegExp]),jt=(e,t)=>{const{length:r}=e,n=new Array(r);t.set(e,n);for(let o=0;o<r;o++)n[o]=U(e[o],t);return n},Gt=(e,t)=>{const r=new Map;t.set(e,r);for(const[n,o]of e)r.set(U(n,t),U(o,t));return r},Ht=(e,t)=>{const r={};t.set(e,r);for(const n in e)r[n]=U(e[n],t);return r},Ft=e=>{const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t},Kt=(e,t)=>{const r=new Set;t.set(e,r);for(const n of e)r.add(U(n,t));return r},Vt=(e,t)=>{if(typeof e!="object"||e===null)return e;if(kt(e))return jt(e,t);if(typeof e.slice=="function")return e.slice();const{constructor:r}=e;if(Bt.has(r)){if(r===Map)return Gt(e,t);if(r===Set)return Kt(e,t);if(r===Date)return new Date(e.getTime());if(r===RegExp)return Ft(e)}return Ht(e,t)},U=(e,t)=>{const r=t||new Map,n=r.get(e);return n||Vt(e,r)};var Yt=pe.default=U,_e={},Y={};Object.defineProperty(Y,"__esModule",{value:!0});const Re=u,{is:Wt,keys:Ee,prototype:qt}=Object,{hasOwnProperty:zt,toString:Xt,valueOf:Jt}=qt,Pe=typeof Node=="function"?Node:void 0,Qt=(e,t)=>{const r=new Map,n=(o,a)=>{if(o&&a&&typeof o=="object"&&typeof a=="object"){const{constructor:s}=o;if(s!==a.constructor)return!1;if(r.get(o)===a)return!0;r.set(o,a);let c,i,l;if(Re.CONSTRUCTORS_COMPARABLE.has(s))if(s===Array){if(c=o.length,c!==a.length)return!1;for(i=c;i--!==0;)if(!n(o[i],a[i]))return!1;return!0}else if(s===Map){if(o.size!==a.size)return!1;for(i of o.entries())if(!a.has(i[0]))return!1;for(i of o.entries())if(!n(i[1],a.get(i[0])))return!1;return!0}else if(s===Set){if(o.size!==a.size)return!1;for(i of o.entries())if(!a.has(i[0]))return!1;return!0}else{if(s===RegExp)return o.flags===a.flags&&o.source===a.source;if(s===ArrayBuffer&&(o=new Uint8Array(o),a=new Uint8Array(a)),c=o.length,c!==a.length)return!1;for(i=c;i--!==0;)if(o[i]!==a[i])return!1;return!0}if(Re.CONSTRUCTORS_UNSUPPORTED.has(s))return o===a;if(o.valueOf!==Jt)return o.valueOf()===a.valueOf();if(o.toString!==Xt)return o.toString()===a.toString();if(Pe&&o instanceof Pe)return o===a;if(l=Ee(o),c=l.length,c!==Ee(a).length)return!1;for(i=c;i--!==0;)if(!zt.call(a,l[i]))return!1;for(i=c;i--!==0;){const f=l[i];if(!n(o[f],a[f]))return!1}return!0}return Wt(o,a)};return n(e,t)};Y.default=Qt;var W={};Object.defineProperty(W,"__esModule",{value:!0});const Zt=/[\\^$.*+?()[\]{}|]/g,er=new RegExp(`^${Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(Zt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")}$`),tr=e=>er.test(e.toString());W.default=tr;var q={};Object.defineProperty(q,"__esModule",{value:!0});const{getPrototypeOf:rr,prototype:nr}=Object,or=e=>{if(typeof e!="object"||e===null)return!1;const t=rr(e);return t===null||t===nr};q.default=or;Object.defineProperty(_e,"__esModule",{value:!0});const x=u,sr=Y,Ae=W,we=q,{assign:Q}=Object,He=(e,t,r="")=>{const n={},o={},a={};if(we.default(e)&&we.default(t)){for(const s in e)if(!t.hasOwnProperty(s))o[`${r}${r?".":""}${s}`]=e[s];else{const c=He(e[s],t[s],`${r}${r?".":""}${s}`);Q(n,c.added),Q(o,c.deleted),Q(a,c.updated)}for(const s in t)e.hasOwnProperty(s)||(n[`${r}${r?".":""}${s}`]=t[s])}else if(r){const s=e&&e.constructor,c=t&&e.constructor;!(s&&!x.CONSTRUCTORS_SUPPORTED.has(s)&&(x.CONSTRUCTORS_UNSUPPORTED.has(s)||!Ae.default(s)))&&!(c&&!x.CONSTRUCTORS_SUPPORTED.has(c)&&(x.CONSTRUCTORS_UNSUPPORTED.has(c)||!Ae.default(c)))&&!sr.default(e,t)&&(a[r]={before:e,after:t})}return{added:n,deleted:o,updated:a}};_e.default=He;Object.defineProperty(b,"__esModule",{value:!0});const I=u,ar=he,cr=pe,ir=_e,lr=Y,Ce=W,ur=q,fr={clone:ar.default,cloneDeep:cr.default,diff:ir.default,isEqual:lr.default,isNative:Ce.default,isPlainObject:ur.default,isValueUnproxiable:e=>{if(e===null)return!0;const t=typeof e;if(t!=="object"&&t!=="function")return!0;const{constructor:r}=e;return I.CONSTRUCTORS_IMMUTABLE.has(r)||!I.CONSTRUCTORS_SUPPORTED.has(r)&&(I.CONSTRUCTORS_UNSUPPORTED.has(r)||!Ce.default(r))},isStrictlyImmutableMethod:e=>I.STRICTLY_IMMUTABLE_METHODS.has(e.name),isLooselyImmutableArrayMethod:e=>I.LOOSELY_IMMUTABLE_METHODS.array.has(e.name)};b.default=fr;Object.defineProperty(de,"__esModule",{value:!0});const dr=b,{apply:hr}=Reflect,{clone:pr,isEqual:_r}=dr.default,yr=(e,t,r,n)=>{const o=pr(r),a=hr(e,t,n),s=!_r(o,r);return[a,s]};de.default=yr;var ye={},z={};Object.defineProperty(z,"__esModule",{value:!0});const{apply:ge}=Reflect,gr=(e,t,r,n)=>r.has(n[0])?[t,!1]:[ge(e,t,n),!0],Sr=(e,t,r,n)=>r.has(n[0])?[ge(e,t,n),!0]:[!1,!1],Tr=(e,t,r,n)=>{const{size:o}=r;return o?[ge(e,t,n),!0]:[void 0,!1]},Or={add:gr,delete:Sr,clear:Tr};z.default=Or;Object.defineProperty(ye,"__esModule",{value:!0});const Fe=z,{apply:Rr}=Reflect,Er=(e,t,r,n)=>{const[o,a]=n,s=r.get(o);return s===a&&(s!==void 0||r.has(o))?[t,!1]:[Rr(e,t,n),!0]},Pr=Fe.default.delete,Ar=Fe.default.clear,wr={set:Er,delete:Pr,clear:Ar};ye.default=wr;Object.defineProperty(le,"__esModule",{value:!0});const Cr=ue,Mr=fe,mr=de,vr=ye,Ur=z,$r={Array:Cr.default,Date:Mr.default,fallback:mr.default,Map:vr.default,Set:Ur.default};le.default=$r;Object.defineProperty(ie,"__esModule",{value:!0});const Z=le,Ke={get(e,t){const r=Z.default[e.name];return r&&r[t.name]||Z.default.fallback},execute(e,t,r,n){return Ke.get(r.constructor,e)(e,t,r,n)}};ie.default=Ke;var N={};Object.defineProperty(N,"__esModule",{value:!0});const Ir=u;function Dr(e){return!!e&&e[Ir.$IS_PROXY]===!0}N.default=Dr;var X={};Object.defineProperty(X,"__esModule",{value:!0});const Lr=u;function br(e){return e&&(e[Lr.$TARGET]||e)}X.default=br;Object.defineProperty(ce,"__esModule",{value:!0});const Nr=ie,O=u,xr=N,Me=X,kr=b,{isArray:Br}=Array,{getOwnPropertyDescriptor:me}=Object,{apply:ve,defineProperty:Ue,deleteProperty:jr,get:ee,set:$e}=Reflect,{execute:Gr}=Nr.default,{isEqual:Ie,isLooselyImmutableArrayMethod:Hr,isStrictlyImmutableMethod:Fr,isValueUnproxiable:Kr}=kr.default,Vr={get(e,t,r){if(t==="constructor")return e.constructor;if(typeof t=="symbol"){if(t===O.$TARGET)return e;if(t===O.$GET_RECORD_START)return this.getPathsRecording=!0;if(t===O.$GET_RECORD_STOP){const i=this.getPaths;return this.getPathsRecording=!1,this.getPaths=[],i}if(t===O.$IS_PROXY)return!0;if(t===O.$STOP)return this.stopped=!0,this.changedPaths=void 0,this.paths=void 0,e;const c=ee(e,t,r);return typeof c=="function"?c.bind(e):c}r=r[O.$TARGET]||r,this.getPathsRecording&&!this.getParentPath(e)&&this.getPaths.push(t);const n=ee(e,t,r);if(this.stopped||Kr(n))return n;const o=me(e,t);if(o&&!o.configurable&&!o.writable)return n;if(typeof n=="function"&&Fr(n))return n.bind(e);this.setChildPath(e,n,t),O.IS_DEVELOPMENT&&this.checkChildIsRoot(n);const a=this.proxies.get(n);if(a)return a;const s=new Proxy(n,this.traps);return this.proxies.set(n,s),s},set(e,t,r,n){if(r=Me.default(r),this.stopped||typeof t=="symbol")return $e(e,t,r,n);n=n[O.$TARGET]||n;const o=r===void 0,a=o&&t in e,s=o&&!a,c=!s&&ee(e,t,n),i=$e(e,t,r,n);return i&&(s||!Ie(c,r))?this.triggerChange(i,this.getChildPath(e,t)):i},defineProperty(e,t,r){if(this.stopped||typeof t=="symbol")return Ue(e,t,r);const n=me(e,t),o=Ue(e,t,r);if(o){const a=Object.assign({configurable:!1,enumerable:!1,writable:!1},r);if(Ie(n,a))return!0}return o&&this.triggerChange(o,this.getChildPath(e,t))},deleteProperty(e,t){if(!(t in e))return!0;const r=jr(e,t);return this.stopped||typeof t=="symbol"?r:r&&this.triggerChange(r,this.getChildPath(e,t))},apply(e,t,r){if(!xr.default(t))return ve(e,t,r);const n=Br(t);if(this.stopped||n&&Hr(e))return ve(e,t,r);const o=n?t[O.$TARGET]:Me.default(t);n||(t=o);const[a,s]=Gr(e,t,o,r);return s?this.triggerChange(a,this.getParentPath(o)):a}};ce.default=Vr;Object.defineProperty(ae,"__esModule",{value:!0});const Yr=u,Wr=ce;class qr{constructor(t,r){this.stopped=!1,this.changed=!1,this.changedPaths=[],this.getPathsRecording=!1,this.getPaths=[],this.paths=new WeakMap,this.proxies=new WeakMap,this.trapDepth=0,this.object=t,this.callback=r,this.traps=this.wrapTraps(Wr.default)}checkChildIsRoot(t){if(t===this.object)throw new Error(`A reference to the whole watched object has been found at path "${this.paths.get(t)}", this is not supported.`)}checkChildPathDuplicate(t,r){const n=this.paths.get(t);if(r!==n&&!(!n||!Object.is(t,n.split(".").reduce((o,a)=>o[a]||{},this.object))))throw new Error(`Duplicate object encountered, the same object is being referenced both at path "${n}" and at path "${r}". Duplicate objects in a watched object are not supported.`)}getChildPath(t,r){const n=this.getParentPath(t);return n?`${n}.${r}`:`${r}`}getParentPath(t){return this.paths.get(t)||""}setChildPath(t,r,n){const o=this.getChildPath(t,n);Yr.IS_DEVELOPMENT&&Object.getPrototypeOf(t)[n]!==r&&this.checkChildPathDuplicate(r,o),this.paths.set(r,o)}triggerChange(t,r){return this.changed=!0,this.changedPaths.push(r),t}wrapTrap(t){const r=this;return function(){r.trapDepth++;const o=t.apply(r,arguments);if(r.trapDepth--,!r.trapDepth&&r.changed&&!r.stopped){const a=r.changedPaths;r.changed=!1,r.changedPaths=[],r.callback(a)}return o}}wrapTraps(t){return{get:this.wrapTrap(t.get),set:this.wrapTrap(t.set),defineProperty:this.wrapTrap(t.defineProperty),deleteProperty:this.wrapTrap(t.deleteProperty),apply:this.wrapTrap(t.apply)}}}ae.default=qr;Object.defineProperty(se,"__esModule",{value:!0});const zr=ae;function Xr(e,t){return new zr.default(e,t).traps}se.default=Xr;var J={};Object.defineProperty(J,"__esModule",{value:!0});const Jr=u;function Qr(e){return e&&(e[Jr.$STOP]||e)}J.default=Qr;Object.defineProperty(oe,"__esModule",{value:!0});const Zr=se,en=J,tn=b;function rn(e,t){if(tn.default.isValueUnproxiable(e))return[e,()=>e];const r=new Proxy(e,Zr.default(e,t));return[r,()=>en.default(r)]}oe.default=rn;var Se={};Object.defineProperty(Se,"__esModule",{value:!0});const k=u,nn=N;function on(e,t){if(Array.isArray(e)&&!nn.default(e)){const r=new Map,{length:n}=e;for(let o=0;o<n;o++)e[o][k.$GET_RECORD_START];t.apply(void 0,e);for(let o=0;o<n;o++)r.set(e[o],e[o][k.$GET_RECORD_STOP]);return r}else return e[k.$GET_RECORD_START],t(e),e[k.$GET_RECORD_STOP]}Se.default=on;Object.defineProperty(S,"__esModule",{value:!0});var j=S.isProxy=L=S.target=S.record=S.unwatch=Ve=S.watch=void 0;const sn=oe;var Ve=S.watch=sn.default;const an=J;S.unwatch=an.default;const cn=Se;S.record=cn.default;const ln=X;var L=S.target=ln.default;const un=N;j=S.isProxy=un.default;function te(e,t,r){if(!e||typeof e!="object"||!t||typeof t!="object")throw new Error("both arguments must be objects or arrays");r||(r=function(c){return c});function n({obj1:c,obj2:i,basePath:l,basePathForRemoves:f,diffs:h}){var _=Object.keys(c),y=_.length,p=Object.keys(i),T=p.length,P,g=c.length-i.length;if(dn(c,i)){for(var d=0;d<y;d++){var R=Array.isArray(c)?Number(_[d]):_[d];R in i||(P=f.concat(R),h.remove.push({op:"remove",path:r(P)}))}for(var d=0;d<T;d++){var R=Array.isArray(i)?Number(p[d]):p[d];a({key:R,obj1:c,obj2:i,path:l.concat(R),pathForRemoves:l.concat(R),diffs:h})}}else{for(var d=0;d<g;d++)P=f.concat(d),h.remove.push({op:"remove",path:r(P)});for(var Ye=c.slice(g),d=0;d<T;d++)a({key:d,obj1:Ye,obj2:i,path:l.concat(d),pathForRemoves:l.concat(d+g),diffs:h})}}var o={remove:[],replace:[],add:[]};return n({obj1:e,obj2:t,basePath:[],basePathForRemoves:[],diffs:o}),o.remove.reverse().concat(o.replace).concat(o.add);function a({key:c,obj1:i,obj2:l,path:f,pathForRemoves:h,diffs:_}){var y=i[c],p=l[c];if(!(c in i)&&c in l){var T=p;_.add.push({op:"add",path:r(f),value:T})}else y!==p&&(Object(y)!==y||Object(p)!==p||fn(y,p)||!Object.keys(y).length&&!Object.keys(p).length&&String(y)!=String(p)?s(f,_,p):n({obj1:i[c],obj2:l[c],basePath:f,basePathForRemoves:h,diffs:_}))}function s(c,i,l){i.replace.push({op:"replace",path:r(c),value:l})}}function fn(e,t){return Object.prototype.toString.call(e)!=Object.prototype.toString.call(t)}function dn(e,t){var r=e.length-t.length;if(Array.isArray(e)&&Array.isArray(t)&&r>0){for(var n=0,o=0,a=0;a<t.length&&String(e[a])===String(t[a]);a++)n++;for(var s=t.length;s>0&&String(e[s+r])===String(t[s]);s--)o++;return n>=o}return!0}var De="remove",Le="replace",hn="add",D="move";function re(e,t,r){if(!e||typeof e!="object")throw new Error("base object must be an object or an array");if(!Array.isArray(t))throw new Error("diff must be an array");for(var n=t.length,o=0;o<n;o++){var a=t[o],s=e,c=a.op,i=be(r,a.path),l=a.from&&be(r,a.from),f,h,_,y,p;if(l){if(f=i,i=l,h=f.slice(),_=h.pop(),B(_),_==null)return!1;for(var T;(T=h.shift())!=null;)B(T),T in y||(y[T]={}),y=y[T]}var P=i.slice(),g=P.pop();if(B(g),g==null)return!1;for(var d;(d=P.shift())!=null;)B(d),d in s||(s[d]={}),s=s[d];if(c===De||c===Le||c===D){var R=c===D?a.from:a.path;if(!s.hasOwnProperty(g))throw new Error(["expected to find property",R,"in object",e].join(" "))}(c===De||c===D)&&(c===D&&(p=s[g]),Array.isArray(s)?s.splice(g,1):delete s[g]),(c===Le||c===hn)&&(s[g]=a.value),c===D&&(s[_]=p)}return s}function be(e,t){if(e){if(t=e(t),!Array.isArray(t))throw new Error(["pathConverter must return an array, returned:",t].join(" "))}else if(!Array.isArray(t))throw new Error(["diff path",t,"must be an array, consider supplying a path converter"].join(" "));return t}function B(e){if(e=="__proto__"||e=="constructor"||e=="prototype")throw new Error("setting of prototype values not supported")}const pn={area:"local"};function M(e){return e===null?!0:!(typeof e=="object"||typeof e=="function")}class _n{constructor(t,r){$(this,"options");$(this,"localStateProxy");$(this,"trackedKeysDict");$(this,"listeners",{});this.trackedKeys=t,this.options={...pn,...r},this.trackedKeysDict=t.reduce((n,o)=>(n[o]=!0,n),{})}addChangeListener(t,r){var n;return typeof this.listeners[t]>"u"&&(this.listeners[t]=[]),(n=this.listeners[t])==null||n.push(r),()=>{var o;this.listeners[t]=(o=this.listeners[t])==null?void 0:o.filter(a=>a!==r)}}async init(){const t=await this.getArea().get(this.trackedKeys),[r,n]=Ve(t,o=>{for(const a of o)for(const[s,c]of Object.entries(this.listeners))if(a.startsWith(s)){const i=this.get(s);for(const l of c)l(Yt(i))}});this.localStateProxy=r,chrome.storage.onChanged.addListener((o,a)=>{if(a===this.options.area){for(let[s,{oldValue:c,newValue:i}]of Object.entries(o))if(this.trackedKeysDict[s]){const l=this.localStateProxy[s];if(!M(l)&&!M(i)){const f=te(this.localStateProxy[s],i);re(this.localStateProxy[s],f)}else l!==i&&(this.localStateProxy[s]=i)}}})}getArea(){switch(this.options.area){case"local":return chrome.storage.local;case"sync":return chrome.storage.sync;case"session":return chrome.storage.session;case"managed":return chrome.storage.managed;default:throw new Error("Unknown storage area.")}}getState(){return L(this.localStateProxy)}get(t){const r=t.split(".");if(!this.trackedKeysDict[r[0]])throw new Error(`Key ${t[0]} should be listed in a constructor of storage.`);let n=this.localStateProxy;for(const o of r){if(typeof n[o]>"u")return;n=n[o]}return j(n)?L(n):n}set(t,r){const n=t.split(".");if(!this.trackedKeysDict[n[0]])throw new Error(`Key ${t[0]} should be listed in a constructor of storage.`);let o=this.localStateProxy;for(let s=0;s<n.length;s++)if(s===n.length-1)if(!M(o[n[s]])&&!M(r)){const c=te(o[n[s]],r);re(o[n[s]],c)}else o[n[s]]=r;else typeof o[n[s]]>"u"&&(o[n[s]]={}),o=o[n[s]];const a=j(this.localStateProxy[n[0]])?L(this.localStateProxy[n[0]]):this.localStateProxy[n[0]];this.getArea().set({[n[0]]:a})}async setAsync(t,r){const n=t.split(".");if(!this.trackedKeysDict[n[0]])throw new Error(`Key ${t[0]} should be listed in a constructor of storage.`);let o=this.localStateProxy;for(let s=0;s<n.length;s++)if(s===n.length-1)if(!M(o[n[s]])&&!M(r)){const c=te(o[n[s]],r);re(o[n[s]],c)}else o[n[s]]=r;else typeof o[n[s]]>"u"&&(o[n[s]]={}),o=o[n[s]];const a=j(this.localStateProxy[n[0]])?L(this.localStateProxy[n[0]]):this.localStateProxy[n[0]];await this.getArea().set({[n[0]]:a})}}const wn=new _n(["user","topMerchants","allMerchants","actualMerchant","activationData","tokens","isActivationProcess","userId","HttpError"]);var E=(e=>(e.GET_RETAILERS="GET_RETAILERS",e.START_LOGIN="START_LOGIN",e.ACTUAL_MERCHANT_FOR_POPUP="ACTUAL_MERCHANT_FOR_POPUP",e.START_CASHBACK_ACTIVATION="START_CASHBACK_ACTIVATION",e.HIDE_SLIDER="HIDE_SLIDER",e.LOGOUT="LOGOUT",e.SAFARI_LOGIN="SAFARI_LOGIN",e.FETCH_USER_INFO="FETCH_USER_INFO",e))(E||{});const[Cn,Mn]=C(E.START_LOGIN),[mn,vn]=C(E.ACTUAL_MERCHANT_FOR_POPUP),[Un,$n]=C(E.START_CASHBACK_ACTIVATION),[In,Dn]=C(E.HIDE_SLIDER),[Ln,bn]=C(E.LOGOUT),[Nn,xn]=C(E.SAFARI_LOGIN),[kn,Bn]=C(E.FETCH_USER_INFO),yn="https://api.monetha.io",jn=`${yn}/affiliates/v1`,Gn=1440,Hn=10,Fn=1e3*60*60,Kn="https://www.monetha.io/login/?extension=true",Vn="https://www.monetha.io/affiliate";export{Kn as A,Un as B,yn as H,Vn as I,Rn as a,En as b,C as c,Tn as d,Fn as e,jn as f,Sn as g,In as h,Pn as i,Mn as j,Bn as k,Cn as l,vn as m,bn as n,On as o,xn as p,$n as q,An as r,wn as s,Dn as t,Gn as u,Hn as v,kn as w,Nn as x,mn as y,Ln as z};
